<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Petriolese – Cover Generator</title>

<!-- Google Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@600;700&family=Bangers&display=swap" rel="stylesheet">

<style>
  :root{ --out-w:3508px; --out-h:4961px; }
  html,body{ height:100% }
  body{
    margin:0; background:#0b0c11; color:#fff;
    font-family:system-ui, Arial, sans-serif;
    display:grid; grid-template-rows:auto 1fr auto; min-height:100dvh;
  }
  header, footer{ padding:12px 16px; background:#0f1218; border-bottom:1px solid #1c2230; }
  footer{ border-top:1px solid #1c2230; border-bottom:none; color:#aeb7c6; }
  .controls{ display:flex; gap:10px; flex-wrap:wrap; align-items:center }
  button{ appearance:none; border:1px solid #2a3242; background:#151923; color:#fff; border-radius:8px; padding:10px 14px; cursor:pointer; }
  button:hover{ background:#1a2030; }
  .stage-wrap{ display:grid; place-items:center; padding:16px; }

  .stage{
    position:relative; width:min(96vw, 1100px); aspect-ratio:3508/4961;
    box-shadow:0 20px 60px rgba(0,0,0,.5); border-radius:12px; overflow:hidden; background:#0b0c11;
  }
  #bg{ position:absolute; inset:0; width:100%; height:100%; object-fit:contain; display:block; }

  .sponsor-strip{
    position:absolute; left:0; right:0; bottom:0;
    display:grid; grid-template-columns:repeat(auto-fit, minmax(0, 1fr));
    gap:var(--sponsorGapPx,16px); padding:var(--sponsorPaddingPx,20px);
    align-items:center; justify-items:center;
    background:#fff;
  }
  .sponsor-strip:empty{ display:none; }
  .sponsor-strip .sponsor-logo{
    width:100%; height:auto; max-height:var(--sponsorLogoMaxPx,80px);
    object-fit:contain; filter:drop-shadow(0 4px 12px rgba(0,0,0,.45));
  }

  /* Squadre (loghi+nomi) */
  .side{
    position:absolute; display:flex; flex-direction:column; align-items:center;
    transform: translate(-50%, -50%) rotate(var(--angle,0deg)); transform-origin:center center;
  }
  .side .logo{ display:block; object-fit:contain; width:var(--logoWpx,200px); height:var(--logoHpx,200px); filter:drop-shadow(0 4px 14px rgba(0,0,0,.45)); }
  .side .team-name{ display:inline-block; text-align:center; line-height:1.05; 
    margin-top:var(--nameGapPx,12px); font-family:"Oswald", Arial, sans-serif!important; font-weight:700; text-transform:uppercase;
    color:#fff; white-space:normal; font-size:var(--nameFontPx,40px); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }

  /* Info (righe indipendenti) */
  .info-line{
    position:absolute; transform: translate(-50%, -50%) rotate(var(--angle,0deg)); transform-origin:center;
    font-family:"Oswald", Arial, sans-serif!important; font-weight:700; text-transform:uppercase;
    color:#fff; white-space: nowrap; font-size:var(--fontPx,36px);
  }

  /* QR block (senza freccia) */
  #qrBlock{
    position:absolute; transform: translate(-50%, -50%); transform-origin:center;
    display:grid; grid-template-rows:auto auto; justify-items:center; gap:8px;
  }
  #qrImg{ width:var(--qrSizePx,260px); height:var(--qrSizePx,260px); object-fit:contain; display:block; background:#fff; border-radius:12px; }
  #qrLabel{
    font-family:'Bangers', system-ui, Arial, sans-serif; letter-spacing:1px;
    font-size:var(--qrTextPx,56px); color:#fff; text-shadow:0 3px 0 rgba(0,0,0,.5);
  }

  .note{ font-size:14px; opacity:.85; }
  details.tuning { margin-left:8px; }
  details.tuning summary { cursor:pointer; }
  .grid{ display:grid; gap:8px; grid-template-columns:max-content 220px max-content; align-items:center; }
  .group{ margin-top:8px; padding-top:8px; border-top:1px dashed #2a3242; grid-column:1 / -1; }
  input[type="range"]{ width:220px; }
  .lbl{ opacity:.9; } .val{ font-variant-numeric:tabular-nums; opacity:.85; min-width:56px; display:inline-block; text-align:right; }
</style>
</head>
<body>
  <header>
    <div class="controls">
      <strong>Petriolese – Cover Generator</strong>
      <span id="status" class="note"></span>

      <details class="tuning">
        <summary>⚙️ Manopole</summary>
        <div class="grid">
          <div class="group"><strong>Squadre (loghi + nomi) — controlli unificati</strong></div>
          <div class="lbl">Angolo squadre</div>        <input id="k_team_angle" type="range" min="-20" max="20" step="0.5"><span class="val"></span>
          <div class="lbl">Rail Y (squadre)</div>      <input id="k_team_rail"  type="range" min="-0.10" max="0.10" step="0.002"><span class="val"></span>
          <div class="lbl">Lungo retta (squadre)</div> <input id="k_team_along" type="range" min="-0.40" max="0.60" step="0.005"><span class="val"></span>
          <div class="lbl">Distanza VS</div>           <input id="k_team_dist"  type="range" min="0.10" max="0.50" step="0.005"><span class="val"></span>
          <div class="lbl">Scala logo</div>            <input id="k_team_scale" type="range" min="0.6" max="1.6" step="0.02"><span class="val"></span>
          <div class="lbl">Y extra (entrambi)</div>    <input id="k_team_y"     type="range" min="-0.10" max="0.10" step="0.002"><span class="val"></span>

          <div class="group"><strong>Info (a destra di MATCH DAY)</strong></div>
          <div class="lbl">Angolo info</div>           <input id="k_info_angle" type="range" min="-20" max="20" step="0.5"><span class="val"></span>
          <div class="lbl">Ancora info – lungo retta</div><input id="k_info_along" type="range" min="-0.40" max="0.60" step="0.005"><span class="val"></span>
          <div class="lbl">Ancora info – Y extra</div> <input id="k_info_y"     type="range" min="-0.20" max="0.20" step="0.002"><span class="val"></span>

          <div class="group"><em>Per-riga</em></div>
          <div class="lbl">DATA – scala</div>          <input id="k_date_scale"  type="range" min="0.6" max="2.0" step="0.02"><span class="val"></span>
          <div class="lbl">DATA – lungo retta</div>    <input id="k_date_along"  type="range" min="-0.40" max="0.60" step="0.005"><span class="val"></span>
          <div class="lbl">DATA – Y extra</div>        <input id="k_date_y"      type="range" min="-0.20" max="0.20" step="0.002"><span class="val"></span>

          <div class="lbl">ORA – scala</div>           <input id="k_time_scale"  type="range" min="0.6" max="2.0" step="0.02"><span class="val"></span>
          <div class="lbl">ORA – lungo retta</div>     <input id="k_time_along"  type="range" min="-0.40" max="0.60" step="0.005"><span class="val"></span>
          <div class="lbl">ORA – Y extra</div>         <input id="k_time_y"      type="range" min="-0.20" max="0.20" step="0.002"><span class="val"></span>

          <div class="lbl">CAMPO – scala</div>         <input id="k_field_scale" type="range" min="0.6" max="2.0" step="0.02"><span class="val"></span>
          <div class="lbl">CAMPO – lungo retta</div>   <input id="k_field_along" type="range" min="-0.40" max="0.60" step="0.005"><span class="val"></span>
          <div class="lbl">CAMPO – Y extra</div>       <input id="k_field_y"     type="range" min="-0.20" max="0.20" step="0.002"><span class="val"></span>

          <div class="lbl">PAESE – scala</div>         <input id="k_paese_scale" type="range" min="0.6" max="2.0" step="0.02"><span class="val"></span>
          <div class="lbl">PAESE – lungo retta</div>   <input id="k_paese_along" type="range" min="-0.40" max="0.60" step="0.005"><span class="val"></span>
          <div class="lbl">PAESE – Y extra</div>       <input id="k_paese_y"     type="range" min="-0.20" max="0.20" step="0.002"><span class="val"></span>

          <div class="group"><strong>QR code</strong></div>
          <div class="lbl">QR – X</div>                <input id="k_qr_x"        type="range" min="0.00" max="1.00" step="0.005"><span class="val"></span>
          <div class="lbl">QR – Y</div>                <input id="k_qr_y"        type="range" min="0.00" max="1.00" step="0.005"><span class="val"></span>
          <div class="lbl">QR – scala</div>            <input id="k_qr_scale"    type="range" min="0.5" max="2.0" step="0.02"><span class="val"></span>
          <div class="lbl">SCAN ME – scala</div>       <input id="k_qr_text"     type="range" min="0.6" max="2.0" step="0.02"><span class="val"></span>

          <div class="group"><strong>Strip sponsor</strong></div>
          <div class="lbl">Altezza loghi</div>         <input id="k_sponsor_scale" type="range" min="0.02" max="0.12" step="0.002"><span class="val"></span>
          <div class="lbl">Padding strip</div>        <input id="k_sponsor_pad"   type="range" min="0.00" max="0.08" step="0.002"><span class="val"></span>
        </div>
      </details>

      <div style="margin-left:auto; display:flex; gap:8px">
        <button id="btnRefresh">Rileggi dallo Sheet</button>
        <button id="btnDownload">Scarica PNG (A3, 300dpi)</button>
      </div>
    </div>
  </header>

  <main class="stage-wrap">
    <div id="stage" class="stage" aria-label="Copertina Matchday">
      <img id="bg" src="fixed.svg" alt="Sfondo" />
      <!-- Squadre -->
      <div id="side1" class="side">
        <img id="logo1" class="logo" alt="Logo squadra 1" crossorigin="anonymous" />
        <div id="name1" class="team-name"></div>
      </div>
      <div id="side2" class="side">
        <img id="logo2" class="logo" alt="Logo squadra 2" crossorigin="anonymous" />
        <div id="name2" class="team-name"></div>
      </div>
      <!-- Info -->
      <div id="infoDate"  class="info-line"></div>
      <div id="infoTime"  class="info-line"></div>
      <div id="infoField" class="info-line"></div>
      <div id="infoPaese" class="info-line"></div>

      <!-- QR block -->
      <div id="qrBlock" aria-label="QR code">
        <img id="qrImg" src="qr-code.png" alt="QR code" />
        <div id="qrLabel">SCAN&nbsp;ME</div>
      </div>

      <div id="sponsorStrip" class="sponsor-strip" aria-label="Loghi sponsor"></div>
    </div>
  </main>

  <footer><div class="note">Dati da Google Sheet (Meta + Avversari). “Campo” e “Paese” letti da Avversari per la squadra1. In Meta, “sponsor_logos” elenca sei URL o file in <code>logos/</code>.</div></footer>

  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js" defer></script>
  <script src="script.js" defer></script>
</body>
</html>
